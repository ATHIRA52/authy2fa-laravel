<!DOCTYPE html><html><head><title>Two-Factor Authentication with Authy</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Two-Factor Authentication with Authy"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Two-Factor Authentication with Authy</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Learn to implement two-factor authentication (2FA) in your web app with Twilio-powered Authy. 2FA helps further secure your users' data by validating more than just a password. This tutorial will show you the code to make it happen.</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Application Setup" class="chapter"><div data-title="How It Works" data-file="app/User.php" data-highlight="" class="step"><h2 id="how-it-works">How It Works</h2>
<p>Adding two-factor authentication (2FA) to your web application can help increase the security of your user&#39;s data. <a href="http://en.wikipedia.org/wiki/Multi-factor_authentication">Multi-factor authentication</a> determines the identity of a user by validating one or more of the following &quot;factors&quot;:</p>
<ul>
<li><em>Knowledge Factors</em> (Something a user knows, like a password)</li>
<li><em>Posession Factors</em> (Something a user has, like a mobile phone)</li>
<li><em>Inheritance Factors</em> (Something a user is, like a person with a unique finger print)</li>
</ul>
<p>We&#39;re about to walk you through a sample application that implements a simple login system with a <em>knowledge factor</em> and a <em>posession factor</em>. For the knowledge factor, we will use a standard username/password system. For the possession factor, we will validate that the user has their mobile phone by sending them a one-time passcode in a text message <a href="http://www.authy.com/">sent with Authy via Twilio</a>. Here&#39;s how this works at a high level:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-high-level.png" alt="2FA High Level"></p>
<p>Now it&#39;s time to look at some code! We&#39;ll begin by understanding the moving parts of this example <a href="http://php.net/">PHP</a> application before diving into the actual implementation of the login flow.</p>
</div><div data-title="Our App's Dependencies" data-file="composer.json" class="step"><h2 id="our-app-s-dependencies">Our App&#39;s Dependencies</h2>
<p>Our application relies on a few third party libraries to deliver this application. Some of the notable ones are:</p>
<ul>
<li><a href="http://laravel.com/"><code>laravel</code></a> : A beautiful web framework for PHP developers.</li>
<li><a href="http://www.mysql.com/"><code>mysql</code></a> : A database</li>
<li><a href="https://github.com/authy/authy-php"><code>authy</code></a> : A high-level helper library for working with the Authy API</li>
</ul>
<p>If you haven&#39;t already, now is the time to <a href="https://dashboard.authy.com/signup">sign up for Authy</a>. Create your first application, naming it whatever you wish. After you create your application, your &quot;production&quot; API key will be visible on your <a href="https://dashboard.authy.com">dashboard</a>:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-authy-dashboard.png" alt="Authy Dashboard"></p>
<p>Let&#39;s take a look at how our application is configured next.</p>
</div><div data-title="Application Configuration" data-file="composer.json" class="step"><h2 id="application-configuration">Application Configuration</h2>
<p>We&#39;ll be using MySQL to store information about our user. So make sure you create a MySQL database and ensure database configuration in <code>config/database.php</code> is correct.</p>
<p>Additionally we&#39;ll be accessing the Authy api a lot using the <code>AUTHY_TOKEN</code>, so make sure you have this set as an <a href="//www.twilio.com/blog/2015/02/managing-development-environment-variables-across-multiple-ruby-applications.html">environment variable</a>.</p>
<p>Next, let&#39;s take a look at how we create our User model and register it with Authy.</p>
</div></div><div data-title="Authentication Domain Model" class="chapter"><div data-title="What Goes Into a Login System?" data-file="app/User.php" data-highlight="" class="step"><h2 id="what-goes-into-a-login-system-">What Goes Into a Login System?</h2>
<p>Authentication and authorization are some of the trickiest concepts to get right in a web application, and implementations vary quite a bit from application to application. But generally speaking, every login system has two concepts to implement:</p>
<ul>
<li><code>User</code> : An individual person using the system</li>
<li><code>Session</code> : A series of authenticated interations a user has with the system</li>
</ul>
<p>Laravel ships with a Session service, that is backed-up by our database so all we need to do is create a User model. A class diagram is included below to give you a sense of what each object contains and their relationship to one another:</p>
<p>Let&#39;s take a closer look at what each of these objects can do, starting with the <code>User</code> model.</p>
</div><div data-title="The User Model" data-file="app/User.php" class="step"><h2 id="the-user-model">The User Model</h2>
<p>The <code>User</code> model is responsible for retaining information about the user, such as their full name, mobile phone number, e-mail address, and password.</p>
<p>An instance of a <code>User</code> can do a variety of things related to authentication. It can compare a candidate password against a hashed password stored in the database, which is used to complete the password authentication step of our login flow.</p>
<p>The <code>User</code> is also responsible for our Authy integration for the 2FA step. Using the <code>authy</code> module, the <code>User</code> model can request that a message containing a one-time password be sent to a user via SMS text message. It can also verify a token entered by the user via the Authy API. We&#39;ll dive into these functions in a bit more depth later when we examine the login flow.</p>
<p>To make sure we have a model to test against run:</p>
<pre><code>php artisan migrate
php artisan db:seed
</code></pre><p>Now that we have a User let&#39;s take a look at the Authentication flow.</p>
</div></div><div data-title="The Authentication Flow" class="chapter"><div data-title="The Authentication Flow" data-file="app/Http/Controllers/Auth/AuthController.php" data-highlight="" class="step"><h2 id="the-authentication-flow">The Authentication Flow</h2>
<p>Laravel 5 provides us with a really great built in Authentication framework. We don&#39;t want to reinvent the wheel so we&#39;ll be expanding on what Laravel already provides us. </p>
<p>The first stop on the A-train is the login process. Let&#39;s take a look first at the form and then next at the controller.</p>
</div><div data-title="The Login Form" data-file="resources/views/auth/login.blade.php" data-language="htmlembedded" class="step"><h2 id="the-login-form">The Login Form</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow2.png" alt="2FA Flow Chart Step 2"></p>
<p>On this login form, the user will attempt to validate the first &quot;factor&quot; of their identity, which is a password they already know. The user will enter their e-mail address and password in this form, and will send it to our server for validation.</p>
<p>With a little CSS assist from <a href="http://getbootstrap.com/">Twitter Bootstrap</a> the login form will look something like this:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-screen-login.png" alt="The Login Form"></p>
</div><div data-title="Validate Login Credentials" data-file="app/Http/Controllers/Auth/AuthController.php" data-highlight="42-55" class="step"><h2 id="validate-our-user-s-login-credentials">Validate our User&#39;s Login Credentials</h2>
<p>On the server, this is the handler function for the <code>POST /login</code> route which we requested via our login form. Using the <code>User</code> model, we first find a user instance with the e-mail address in the POST parameters. If that user exists, we test the password that the user entered against the hashed password to see if it&#39;s correct.</p>
<p>If the e-mail / password combination match, we set <code>password_validated</code> to true in the Session and we add our <code>User</code> to the session. Lastly we redirect our request to /auth/twofactor so let&#39;s look at how we send a two-factor auth token using Authy.</p>
</div><div data-title="Sending a 2FA Token" data-file="app/User.php" data-highlight="35-54" class="step"><h2 id="sending-a-2fa-token">Sending a 2FA Token</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow5.png" alt="2FA Flow Chart Step 5"></p>
<p>Before we can send out a one-time password via Authy, we need to <a href="http://docs.authy.com/#section-9">register a new Authy user</a> and obtain a unique ID for that user in their system. We store that ID on our <code>User</code> model to tie our app&#39;s user and the associated Authy user together.</p>
<p>Once there is an Authy user ID associated with our user model, we can request that an SMS verification token be sent out to the user&#39;s phone. Authy supports token validation in their mobile app as well, but for our purposes we&#39;ll just use text messages every time.</p>
<p>We can call this method on the user instance multiple times if needed, which is what happens every time the user clicks &quot;Resend Code&quot; on the web form we are about to look at!</p>
<p>Now that the user has been sent a one-time password via SMS, let&#39;s check out the UI they interact with to validate their code.</p>
</div><div data-title="The Verification Form" data-file="resources/views/auth/twofactor.blade.php" data-language="htmlembedded" class="step"><h2 id="the-verification-form">The Verification Form</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow7.png" alt="2FA Flow Chart Step 7"></p>
<p>On this form, the user will enter the code that was sent to their mobile phone via SMS. If for some reason they didn&#39;t get the code, clicking the &quot;Resend Code&quot; link will initiate an Ajax request to the server which will use Authy to send them a new code.</p>
<p>The verification form will look something like this to the end user:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-screen-verify.png" alt="The Verification Form"></p>
<p>Let&#39;s see how we verify the code they submitted.</p>
</div><div data-title="Validate the Code: Step 1" data-file="app/Http/Controllers/Auth/AuthController.php" data-highlight="61-77" class="step"><h2 id="validating-the-code-on-the-controller">Validating the Code on the Controller</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow8.png" alt="2FA Flow Chart Step 8"></p>
<p>Back in our controller, we grab the 2nd-factor token that was submitted by the user. Before we decide what to do with this token we check to see if the User is part of a validated <code>Session</code>. Once we get the all clear we then check that token by calling <code>verifyToken()</code> on the User model. </p>
<p>This is a great opportunity to dive-in to the verifyToken() function.</p>
</div><div data-title="Validate the Code: Step 2" data-file="app/User.php" data-highlight="56-65" class="step"><h2 id="validating-the-code-with-authy">Validating the Code with Authy</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow8.png" alt="2FA Flow Chart Step 8"></p>
<p>Authy makes it very simple for us to validate the code our user submitted. All we need to do is check with Authy that the code they sent was the same code they entered in our form. To do this our User model simply passes it&#39;s <code>authy_id</code> and the <code>$token</code> to Authy. </p>
<p>And voilah, we have a User who is valid over two-factors of authentication.</p>
</div><div data-title="All Done!" data-file="app/User.php" class="step"><h2 id="all-done-">All Done!</h2>
<p>We now have a working 2FA login system for our application. By using Authy for this, we are able to take advantage of a mobile application for 2FA and let them handle sending international SMS messages. This enables us to spend more time on the actual business logic for our application.</p>
<p>Thanks for checking out this tutorial! If you have any feedback to share with us, we&#39;d love to hear it. Tweet <a href="http://twitter.com/twilio">@twilio</a> to let us know what you think.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="app/User.php" data-mode="php">PD9waHAgbmFtZXNwYWNlIEFwcDsKCnVzZSBBdXRoeVxBdXRoeUFwaSBhcyBBdXRoeUFwaTsKdXNlIElsbHVtaW5hdGVcQXV0aFxBdXRoZW50aWNhdGFibGU7CnVzZSBJbGx1bWluYXRlXERhdGFiYXNlXEVsb3F1ZW50XE1vZGVsOwp1c2UgSWxsdW1pbmF0ZVxBdXRoXFBhc3N3b3Jkc1xDYW5SZXNldFBhc3N3b3JkOwp1c2UgSWxsdW1pbmF0ZVxDb250cmFjdHNcQXV0aFxBdXRoZW50aWNhdGFibGUgYXMgQXV0aGVudGljYXRhYmxlQ29udHJhY3Q7CnVzZSBJbGx1bWluYXRlXENvbnRyYWN0c1xBdXRoXENhblJlc2V0UGFzc3dvcmQgYXMgQ2FuUmVzZXRQYXNzd29yZENvbnRyYWN0OwoKY2xhc3MgVXNlciBleHRlbmRzIE1vZGVsIGltcGxlbWVudHMgQXV0aGVudGljYXRhYmxlQ29udHJhY3QsIENhblJlc2V0UGFzc3dvcmRDb250cmFjdCB7CgoJdXNlIEF1dGhlbnRpY2F0YWJsZSwgQ2FuUmVzZXRQYXNzd29yZDsKCgkvKioKCSAqIFRoZSBkYXRhYmFzZSB0YWJsZSB1c2VkIGJ5IHRoZSBtb2RlbC4KCSAqCgkgKiBAdmFyIHN0cmluZwoJICovCglwcm90ZWN0ZWQgJHRhYmxlID0gJ3VzZXJzJzsKCgkvKioKCSAqIFRoZSBhdHRyaWJ1dGVzIHRoYXQgYXJlIG1hc3MgYXNzaWduYWJsZS4KCSAqCgkgKiBAdmFyIGFycmF5CgkgKi8KCXByb3RlY3RlZCAkZmlsbGFibGUgPSBbJ25hbWUnLCAnZW1haWwnLCAncGFzc3dvcmQnLCAncGhvbmVfbnVtYmVyJywgJ2NvdW50cnlfY29kZSddOwoKCS8qKgoJICogVGhlIGF0dHJpYnV0ZXMgZXhjbHVkZWQgZnJvbSB0aGUgbW9kZWwncyBKU09OIGZvcm0uCgkgKgoJICogQHZhciBhcnJheQoJICovCglwcm90ZWN0ZWQgJGhpZGRlbiA9IFsncGFzc3dvcmQnLCAncmVtZW1iZXJfdG9rZW4nLCAnYXV0aHlfaWQnXTsKCiAgcHVibGljIGZ1bmN0aW9uIHJlZ2lzdGVyX2F1dGh5KCkgewogICAgJGF1dGh5X2FwaSA9IG5ldyBBdXRoeUFwaShnZXRlbnYoJ0FVVEhZX1RPS0VOJykpOwogICAgJHVzZXIgPSAkYXV0aHlfYXBpLT5yZWdpc3RlclVzZXIoJHRoaXMtPmVtYWlsLCAkdGhpcy0+cGhvbmVfbnVtYmVyLCAkdGhpcy0+Y291bnRyeV9jb2RlKTsgLy9lbWFpbCwgY2VsbHBob25lLCBjb3VudHJ5X2NvZGUKCiAgICBpZigkdXNlci0+b2soKSkgewogICAgICR0aGlzLT5hdXRoeV9pZCA9ICR1c2VyLT5pZCgpOyAKICAgICAkdGhpcy0+c2F2ZSgpOwogICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgLy8gc29tZXRoaW5nIHdlbnQgd3JvbmcgCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CgogIHB1YmxpYyBmdW5jdGlvbiBzZW5kVG9rZW4oKSB7CiAgICAkYXV0aHlfYXBpID0gbmV3IEF1dGh5QXBpKGdldGVudignQVVUSFlfVE9LRU4nKSk7CiAgICAkc21zID0gJGF1dGh5X2FwaS0+cmVxdWVzdFNtcygkdGhpcy0+YXV0aHlfaWQpOwoKICAgIHJldHVybiAkc21zLT5vaygpOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIHZlcmlmeVRva2VuKCR0b2tlbikgewogICAgJGF1dGh5X2FwaSA9IG5ldyBBdXRoeUFwaShnZXRlbnYoJ0FVVEhZX1RPS0VOJykpOwogICAgJHZlcmlmaWNhdGlvbiA9ICRhdXRoeV9hcGktPnZlcmlmeVRva2VuKCR0aGlzLT5hdXRoeV9pZCwgJHRva2VuKTsKCiAgICBpZigkdmVyaWZpY2F0aW9uLT5vaygpKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KfQo=</textarea>
<textarea class="saurus-file" data-file="composer.json" data-mode="json">ewoJIm5hbWUiOiAibGFyYXZlbC9sYXJhdmVsIiwKCSJkZXNjcmlwdGlvbiI6ICJUaGUgTGFyYXZlbCBGcmFtZXdvcmsuIiwKCSJrZXl3b3JkcyI6IFsiZnJhbWV3b3JrIiwgImxhcmF2ZWwiXSwKCSJsaWNlbnNlIjogIk1JVCIsCgkidHlwZSI6ICJwcm9qZWN0IiwKCSJyZXF1aXJlIjogewoJCSJsYXJhdmVsL2ZyYW1ld29yayI6ICI1LjAuKiIsCgkJImF1dGh5L3BocCI6ICJ+Mi4yIgoJfSwKCSJyZXF1aXJlLWRldiI6IHsKCQkicGhwdW5pdC9waHB1bml0IjogIn40LjAiLAoJCSJwaHBzcGVjL3BocHNwZWMiOiAifjIuMSIKCX0sCgkiYXV0b2xvYWQiOiB7CgkJImNsYXNzbWFwIjogWwoJCQkiZGF0YWJhc2UiCgkJXSwKCQkicHNyLTQiOiB7CgkJCSJBcHBcXCI6ICJhcHAvIgoJCX0KCX0sCgkiYXV0b2xvYWQtZGV2IjogewoJCSJjbGFzc21hcCI6IFsKCQkJInRlc3RzL1Rlc3RDYXNlLnBocCIKCQldCgl9LAoJInNjcmlwdHMiOiB7CgkJInBvc3QtaW5zdGFsbC1jbWQiOiBbCgkJCSJwaHAgYXJ0aXNhbiBjbGVhci1jb21waWxlZCIsCgkJCSJwaHAgYXJ0aXNhbiBvcHRpbWl6ZSIKCQldLAoJCSJwb3N0LXVwZGF0ZS1jbWQiOiBbCgkJCSJwaHAgYXJ0aXNhbiBjbGVhci1jb21waWxlZCIsCgkJCSJwaHAgYXJ0aXNhbiBvcHRpbWl6ZSIKCQldLAoJCSJwb3N0LWNyZWF0ZS1wcm9qZWN0LWNtZCI6IFsKCQkJInBocCAtciBcImNvcHkoJy5lbnYuZXhhbXBsZScsICcuZW52Jyk7XCIiLAoJCQkicGhwIGFydGlzYW4ga2V5OmdlbmVyYXRlIgoJCV0KCX0sCgkiY29uZmlnIjogewoJCSJwcmVmZXJyZWQtaW5zdGFsbCI6ICJkaXN0IgoJfQp9Cg==</textarea>
<textarea class="saurus-file" data-file="app/Http/Controllers/Auth/AuthController.php" data-mode="php">PD9waHAgbmFtZXNwYWNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXEF1dGg7Cgp1c2UgQXV0aDsKdXNlIFNlc3Npb247CnVzZSBBcHBcVXNlcjsKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKdXNlIElsbHVtaW5hdGVcQ29udHJhY3RzXEF1dGhcR3VhcmQ7CnVzZSBJbGx1bWluYXRlXENvbnRyYWN0c1xBdXRoXFJlZ2lzdHJhcjsKdXNlIElsbHVtaW5hdGVcRm91bmRhdGlvblxBdXRoXEF1dGhlbnRpY2F0ZXNBbmRSZWdpc3RlcnNVc2VyczsKCmNsYXNzIEF1dGhDb250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlciB7CgogIC8qCiAgfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgfCBSZWdpc3RyYXRpb24gJiBMb2dpbiBDb250cm9sbGVyCiAgfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgfAogIHwgVGhpcyBjb250cm9sbGVyIGhhbmRsZXMgdGhlIHJlZ2lzdHJhdGlvbiBvZiBuZXcgdXNlcnMsIGFzIHdlbGwgYXMgdGhlCiAgfCBhdXRoZW50aWNhdGlvbiBvZiBleGlzdGluZyB1c2Vycy4gQnkgZGVmYXVsdCwgdGhpcyBjb250cm9sbGVyIHVzZXMKICB8IGEgc2ltcGxlIHRyYWl0IHRvIGFkZCB0aGVzZSBiZWhhdmlvcnMuIFdoeSBkb24ndCB5b3UgZXhwbG9yZSBpdD8KICB8CiAgKi8KCiAgdXNlIEF1dGhlbnRpY2F0ZXNBbmRSZWdpc3RlcnNVc2VyczsKCiAgLyoqCiAgICogQ3JlYXRlIGEgbmV3IGF1dGhlbnRpY2F0aW9uIGNvbnRyb2xsZXIgaW5zdGFuY2UuCiAgICoKICAgKiBAcGFyYW0gIFxJbGx1bWluYXRlXENvbnRyYWN0c1xBdXRoXEd1YXJkICAkYXV0aAogICAqIEBwYXJhbSAgXElsbHVtaW5hdGVcQ29udHJhY3RzXEF1dGhcUmVnaXN0cmFyICAkcmVnaXN0cmFyCiAgICogQHJldHVybiB2b2lkCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KEd1YXJkICRhdXRoLCBSZWdpc3RyYXIgJHJlZ2lzdHJhcikKICB7CiAgICAkdGhpcy0+YXV0aCA9ICRhdXRoOwogICAgJHRoaXMtPnJlZ2lzdHJhciA9ICRyZWdpc3RyYXI7CgogICAgJHRoaXMtPm1pZGRsZXdhcmUoJ2d1ZXN0JywgWydleGNlcHQnID0+ICdnZXRMb2dvdXQnXSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gcG9zdExvZ2luKFJlcXVlc3QgJHJlcXVlc3QpIHsKICAgICRjcmVkZW50aWFscyA9ICRyZXF1ZXN0LT5vbmx5KCdlbWFpbCcsJ3Bhc3N3b3JkJyk7CiAgICBpZihBdXRoOjp2YWxpZGF0ZSgkY3JlZGVudGlhbHMpKSB7CiAgICAgICR1c2VyID0gVXNlcjo6d2hlcmUoJ2VtYWlsJywgJz0nLCAkcmVxdWVzdC0+aW5wdXQoJ2VtYWlsJykpLT5maXJzdE9yRmFpbCgpOyAKICAgICAgJHVzZXItPnNlbmRUb2tlbigpOwogICAgICBTZXNzaW9uOjpzZXQoJ3Bhc3N3b3JkX3ZhbGlkYXRlZCcsIHRydWUpOwogICAgICBTZXNzaW9uOjpzZXQoJ2lkJywgJHVzZXItPmlkKTsKICAgICAgcmV0dXJuIHJlZGlyZWN0KCcvYXV0aC90d29mYWN0b3InKTsgCiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiByZWRpcmVjdCgnL2F1dGgvbG9naW4nKS0+d2l0aEVycm9ycyhbCiAgICAgICAgICAgICdlbWFpbCcgPT4gJ1RoZSBlbWFpbCBhbmQgcGFzc3dvcmQgY29tYmluYXRpb24geW91IGVudGVyZWQgaXMgaW5jb3JyZWN0LicsCiAgICAgICAgXSk7CiAgICB9CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gZ2V0VHdvZmFjdG9yKCkgewogICAgcmV0dXJuIHZpZXcoJ2F1dGgvdHdvZmFjdG9yJyk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gcG9zdFR3b2ZhY3RvcihSZXF1ZXN0ICRyZXF1ZXN0KSB7CiAgICBpZighU2Vzc2lvbjo6Z2V0KCdwYXNzd29yZF92YWxpZGF0ZWQnKSB8fCAhU2Vzc2lvbjo6Z2V0KCdpZCcpKSB7CiAgICAgIHJldHVybiByZWRpcmVjdCgnL2F1dGgvbG9naW4nKTsKICAgIH0KCiAgICBpZihpc3NldCgkX1BPU1RbJ3Rva2VuJ10pKSB7CiAgICAgJHVzZXIgPSBVc2VyOjpmaW5kKFNlc3Npb246OmdldCgnaWQnKSk7CiAgICAgaWYoJHVzZXItPnZlcmlmeVRva2VuKCRyZXF1ZXN0LT5pbnB1dCgndG9rZW4nKSkpIHsKICAgICAgIEF1dGg6OmxvZ2luKCR1c2VyKTsKICAgICAgIHJldHVybiByZWRpcmVjdCgpLT5pbnRlbmRlZCgnL2hvbWUnKTsKICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiByZWRpcmVjdCgnL2F1dGgvdHdvZmFjdG9yJyktPndpdGhFcnJvcnMoWwogICAgICAgICAgICAndG9rZW4nID0+ICdUaGUgdG9rZW4geW91IGVudGVyZWQgaXMgaW5jb3JyZWN0JywKICAgICAgICBdKTsKICAgICB9CiAgICB9CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gcG9zdFJlZ2lzdGVyKFJlcXVlc3QgJHJlcXVlc3QpCiAgewogICAgJHZhbGlkYXRvciA9ICR0aGlzLT5yZWdpc3RyYXItPnZhbGlkYXRvcigkcmVxdWVzdC0+YWxsKCkpOwogICAgaWYgKCR2YWxpZGF0b3ItPmZhaWxzKCkpCiAgICB7CiAgICAgICR0aGlzLT50aHJvd1ZhbGlkYXRpb25FeGNlcHRpb24oCiAgICAgICAgJHJlcXVlc3QsICR2YWxpZGF0b3IKICAgICAgKTsKICAgIH0KICAgICR1c2VyID0gJHRoaXMtPnJlZ2lzdHJhci0+Y3JlYXRlKCRyZXF1ZXN0LT5hbGwoKSk7CiAgICAkdXNlci0+cmVnaXN0ZXJfYXV0aHkoKTsKICAgICR1c2VyLT5zZW5kVG9rZW4oKTsKICAgIFNlc3Npb246OnNldCgncGFzc3dvcmRfdmFsaWRhdGVkJywgdHJ1ZSk7CiAgICBTZXNzaW9uOjpzZXQoJ2lkJywgJHVzZXItPmlkKTsKICAgIHJldHVybiByZWRpcmVjdCgnL2F1dGgvdHdvZmFjdG9yJyk7CiAgfQoKfQo=</textarea>
<textarea class="saurus-file" data-file="resources/views/auth/login.blade.php" data-mode="php">QGV4dGVuZHMoJ2FwcCcpCgpAc2VjdGlvbignY29udGVudCcpCjxkaXYgY2xhc3M9ImNvbnRhaW5lci1mbHVpZCI+CiAgPGRpdiBjbGFzcz0icm93Ij4KICAgIDxkaXYgY2xhc3M9ImNvbC1tZC04IGNvbC1tZC1vZmZzZXQtMiI+CiAgICAgIDxkaXYgY2xhc3M9InBhbmVsIHBhbmVsLWRlZmF1bHQiPgogICAgICAgIDxkaXYgY2xhc3M9InBhbmVsLWhlYWRpbmciPkxvZ2luPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0icGFuZWwtYm9keSI+CiAgICAgICAgICBAaWYgKGNvdW50KCRlcnJvcnMpID4gMCkKICAgICAgICAgICAgPGRpdiBjbGFzcz0iYWxlcnQgYWxlcnQtZGFuZ2VyIj4KICAgICAgICAgICAgICA8c3Ryb25nPldob29wcyE8L3N0cm9uZz4gVGhlcmUgd2VyZSBzb21lIHByb2JsZW1zIHdpdGggeW91ciBpbnB1dC48YnI+PGJyPgogICAgICAgICAgICAgIDx1bD4KICAgICAgICAgICAgICAgIEBmb3JlYWNoICgkZXJyb3JzLT5hbGwoKSBhcyAkZXJyb3IpCiAgICAgICAgICAgICAgICAgIDxsaT57eyAkZXJyb3IgfX08L2xpPgogICAgICAgICAgICAgICAgQGVuZGZvcmVhY2gKICAgICAgICAgICAgICA8L3VsPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIEBlbmRpZgoKICAgICAgICAgIDxmb3JtIGNsYXNzPSJmb3JtLWhvcml6b250YWwiIHJvbGU9ImZvcm0iIG1ldGhvZD0iUE9TVCIgYWN0aW9uPSIvYXV0aC9sb2dpbiI+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9Il90b2tlbiIgdmFsdWU9Int7IGNzcmZfdG9rZW4oKSB9fSI+CgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImNvbC1tZC00IGNvbnRyb2wtbGFiZWwiPkUtTWFpbCBBZGRyZXNzPC9sYWJlbD4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiI+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iZW1haWwiIGNsYXNzPSJmb3JtLWNvbnRyb2wiIG5hbWU9ImVtYWlsIiB2YWx1ZT0ie3sgb2xkKCdlbWFpbCcpIH19Ij4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImNvbC1tZC00IGNvbnRyb2wtbGFiZWwiPlBhc3N3b3JkPC9sYWJlbD4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiI+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icGFzc3dvcmQiIGNsYXNzPSJmb3JtLWNvbnRyb2wiIG5hbWU9InBhc3N3b3JkIj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBjb2wtbWQtb2Zmc2V0LTQiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2hlY2tib3giPgogICAgICAgICAgICAgICAgICA8bGFiZWw+CiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSJyZW1lbWJlciI+IFJlbWVtYmVyIE1lCiAgICAgICAgICAgICAgICAgIDwvbGFiZWw+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBjb2wtbWQtb2Zmc2V0LTQiPgogICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJzdWJtaXQiIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIHN0eWxlPSJtYXJnaW4tcmlnaHQ6IDE1cHg7Ij4KICAgICAgICAgICAgICAgICAgTG9naW4KICAgICAgICAgICAgICAgIDwvYnV0dG9uPgoKICAgICAgICAgICAgICAgIDxhIGhyZWY9Ii9wYXNzd29yZC9lbWFpbCI+Rm9yZ290IFlvdXIgUGFzc3dvcmQ/PC9hPgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDwvZm9ybT4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICA8L2Rpdj4KPC9kaXY+CkBlbmRzZWN0aW9uCg==</textarea>
<textarea class="saurus-file" data-file="resources/views/auth/twofactor.blade.php" data-mode="php">QGV4dGVuZHMoJ2FwcCcpCgpAc2VjdGlvbignY29udGVudCcpCjxkaXYgY2xhc3M9ImNvbnRhaW5lci1mbHVpZCI+CiAgPGRpdiBjbGFzcz0icm93Ij4KICAgIDxkaXYgY2xhc3M9ImNvbC1tZC04IGNvbC1tZC1vZmZzZXQtMiI+CiAgICAgIDxkaXYgY2xhc3M9InBhbmVsIHBhbmVsLWRlZmF1bHQiPgogICAgICAgIDxkaXYgY2xhc3M9InBhbmVsLWhlYWRpbmciPkxvZ2luPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0icGFuZWwtYm9keSI+CiAgICAgICAgICBAaWYgKGNvdW50KCRlcnJvcnMpID4gMCkKICAgICAgICAgICAgPGRpdiBjbGFzcz0iYWxlcnQgYWxlcnQtZGFuZ2VyIj4KICAgICAgICAgICAgICA8c3Ryb25nPldob29wcyE8L3N0cm9uZz4gVGhlcmUgd2VyZSBzb21lIHByb2JsZW1zIHdpdGggeW91ciBpbnB1dC48YnI+PGJyPgogICAgICAgICAgICAgIDx1bD4KICAgICAgICAgICAgICAgIEBmb3JlYWNoICgkZXJyb3JzLT5hbGwoKSBhcyAkZXJyb3IpCiAgICAgICAgICAgICAgICAgIDxsaT57eyAkZXJyb3IgfX08L2xpPgogICAgICAgICAgICAgICAgQGVuZGZvcmVhY2gKICAgICAgICAgICAgICA8L3VsPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIEBlbmRpZgoKICAgICAgICAgIDxmb3JtIGNsYXNzPSJmb3JtLWhvcml6b250YWwiIHJvbGU9ImZvcm0iIG1ldGhvZD0iUE9TVCIgYWN0aW9uPSIvYXV0aC90d29mYWN0b3IiPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJfdG9rZW4iIHZhbHVlPSJ7eyBjc3JmX3Rva2VuKCkgfX0iPgoKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CiAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJjb2wtbWQtNCBjb250cm9sLWxhYmVsIj5FbnRlciBUb2tlbjwvbGFiZWw+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTYiPgogICAgICAgICAgICAgICAgPGlucHV0IGlkPSJhdXRoeS10b2tlbiIgdHlwZT0ic3RyaW5nIiBjbGFzcz0iZm9ybS1jb250cm9sIiBuYW1lPSJ0b2tlbiIgdmFsdWU9IiI+CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTYgY29sLW1kLW9mZnNldC00Ij4KICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0ic3VibWl0IiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IiBzdHlsZT0ibWFyZ2luLXJpZ2h0OiAxNXB4OyI+CiAgICAgICAgICAgICAgICAgIFZlcmlmeQogICAgICAgICAgICAgICAgPC9idXR0b24+CgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDwvZm9ybT4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICA8L2Rpdj4KPC9kaXY+CkBlbmRzZWN0aW9uCg==</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>